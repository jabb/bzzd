{"tagline":"Drunkard's Walk 2D Map Generator","google":"","note":"Don't delete this file! It's used internally to help with page regeneration.","name":"libdrunkard","body":"## A Drunk Introduction\r\nIf you're looking to procedurally generate 2D maps, libdrunkard may be what you're looking for. This library uses a fine tuned drunkard's walk alogirithm (see: http://en.wikipedia.org/wiki/Random_walk). Basically, you'll have a walker (or a drunk, as this library calls it) who walks around the map carving tunnels and various other structures.\r\n\r\nHere's a good example of what you can create (quite simply too!):\r\n\r\n![libdrunkard](http://dl.dropbox.com/u/11665683/drunkard1.png)\r\n\r\n## Compiling Drunkard\r\n\r\nOn most systems, you can simply do `make && make install` to get the library working on your computer. The library itself is very small, 57kb with debugging enabled.\r\n\r\nIf the libdrunkard fails to compile on your system, feel free to contact me at my GitHub: @jabb.\r\n\r\n## Using Drunkard\r\n\r\nIn order to use libdrunkard, all you need to do is include the header file `<dunkard.h>` and link against the library by passing `-ldrunkard` to GCC, or some other compiler. After that you need to have your map already defined and then you can create your drunk. The map needs to be an array or multidimensional array of unsigned numbers, if multidimensional, height must be indexed first, like below:\r\n\r\n```\r\nunsigned map[MAP_HEIGHT][MAP_WIDTH] = {{0}};\r\n/* Create the drunk. */\r\nstruct drunkard *drunk = drunkard_create((void *)map, MAP_WIDTH, MAP_HEIGHT);\r\n\r\n/* Carve out a random map. */\r\n/* ... */\r\n\r\n/* Destroy the drunk. */\r\ndrunkard_destroy(drunk);\r\n```\r\n\r\nSome technical notes:\r\n\r\n* libdrunkard uses it's own custom random number generator (CMWC) which is seeded automatically. You can get the current seed with `drunkard_get_seed` and set it manually with `drunkard_seed`.\r\n* libdrunkard recognizes numbers passing a certain threshold as open (walkable) tiles. This threshold can be set manually with `drunkard_set_opened_threshold`. The default is 1, so only a tile that has the value of 0 can't be walked upon.\r\n* libdrunkard keeps a list of tiles that have been opened and tiles that might be opened after a flush, the latter are called marks. \"Marking\" tiles is the preferable way to set tiles during a carving process, that way any tiles that open up don't confuse the drunkard thinking he's found the main tunnel system. There are various marking functions, but only one way to flush them: `drunkard_flush_marks`. Flush only when you're absolutely sure you've connected with the rest of your walkable area, or you know you can get back to the disconnected area.\r\n* libdrunkard's marks tiles only relative to the current position and target of the drunk. When you're carving, at some point you should **always** target a random open tile and head towards it. There are always exceptions of course, but this is a good rule so you can be sure your drunk connects to a walkable area.\r\n* libdrunkard's main stepping function uses a weight to calculate how stumbly the drunk will be. The weight is on a scale from 0.0 to 1.0. A value of 0.0 means the drunk will move directly away from his target, a value of 1.0 will mean directory towards, and a value of 0.5 means he'll just randomly walk around. I like values between 0.6 and 0.9 to be sure the drunk reaches his target.\r\n\r\n## Function Documentation\r\n\r\n### Drunk Creation/Destruction\r\n\r\n```\r\nstruct drunkard *drunkard_create(unsigned *tiles, unsigned width, unsigned height);\r\nvoid drunkard_destroy(struct drunkard *drunk);\r\n```\r\n\r\nIn order to use the drunk, you have to create him. He takes a pointer to an array of unsigned integers. These integers will mostly likely be key-lookups to table of your real tiles. `drunkard_create` returns `NULL` only if there is no memory left. After you're done, be sure to destroy it, freeing any resources.\r\n\r\n### Core Functions\r\n\r\n```\r\nbool drunkard_is_opened(struct drunkard *drunk, int x, int y);\r\nvoid drunkard_set_open_threshold(struct drunkard *drunk, unsigned threshold);\r\nvoid drunkard_mark(struct drunkard *drunk, int x, int y, unsigned tile);\r\nvoid drunkard_flush_marks(struct drunkard *drunk);\r\n```\r\n\r\n`drunkard_is_opened` checks the tile at `x, y` and returns true if it is opened (walkable).\r\n\r\n`drunkard_set_open_threshold` sets the threshold for open tiles. Anything greater than or equal to this number are considered by the drunk walkable.\r\n\r\n`drunkard_mark` marks a tile. If the tile is an open one (walkable), it is added to the list of marked tiles. If the tile is closed (unwalkable), it is removed from the list of open tiles and list marked tiles.\r\n\r\n`drunkard_flush_marks` flushes all the marked tiles to the list of open tiles. The marked list is then cleared.\r\n\r\n### Querying Functions\r\n\r\n```\r\nunsigned drunkard_count_opened(struct drunkard *drunk);\r\ndouble drunkard_percent_opened(struct drunkard *drunk);\r\nvoid drunkard_random_opened(struct drunkard *drunk, unsigned *x, unsigned *y);\r\n\r\nint drunkard_get_x(struct drunkard *drunk);\r\nint drunkard_get_y(struct drunkard *drunk);\r\nint drunkard_get_target_x(struct drunkard *drunk);\r\nint drunkard_get_target_y(struct drunkard *drunk);\r\nint drunkard_get_dx_to_target(struct drunkard *drunk);\r\nint drunkard_get_dy_to_target(struct drunkard *drunk);\r\n```\r\n\r\n`drunkard_count_opened` returns the number of opened tiles on the map. (Doesn't include marked.)\r\n\r\n`drunkard_percent_opened` returns the percent of the tiles opened on the map. Half the map opened would be 0.5.\r\n\r\n`drunkard_random_opened` sets `x` and `y` to a random opened point on the map. (Doesn't include marked.)\r\n\r\nThe rest of the functions should be self explanatory.\r\n\r\n### Random Number Generation\r\n\r\n```\r\nunsigned drunkard_get_seed(struct drunkard *drunk);\r\nvoid drunkard_seed(struct drunkard *drunk, unsigned s);\r\ndouble drunkard_rng_uniform(struct drunkard *drunk);\r\ndouble drunkard_rng_under(struct drunkard *drunk, unsigned limit);\r\nint drunkard_rng_range(struct drunkard *drunk, int low, int high);\r\nbool drunkard_rng_chance(struct drunkard *drunk, double d);\r\n```\r\n\r\n`drunkard_get_seed` returns the current seed.\r\n\r\n`drunkard_seed` sets the current seed.\r\n\r\n`drunkard_rng_uniform` returns a double in the range [0, 1).\r\n\r\n`drunkard_rng_under` returns a double in the range [0, limit).\r\n\r\n`drunkard_rng_range` returns an int in the range [low, high].\r\n\r\n`drunkard_rng_chance` returns true `d` percent of the time.\r\n\r\n### Starting/Targeting Functions\r\n\r\n```\r\nvoid drunkard_start_fixed(struct drunkard *drunk, int x, int y);\r\nvoid drunkard_start_random(struct drunkard *drunk);\r\nvoid drunkard_start_random_west(struct drunkard *drunk);\r\nvoid drunkard_start_random_east(struct drunkard *drunk);\r\nvoid drunkard_start_random_north(struct drunkard *drunk);\r\nvoid drunkard_start_random_south(struct drunkard *drunk);\r\nvoid drunkard_start_random_west_edge(struct drunkard *drunk);\r\nvoid drunkard_start_random_east_edge(struct drunkard *drunk);\r\nvoid drunkard_start_random_north_edge(struct drunkard *drunk);\r\nvoid drunkard_start_random_south_edge(struct drunkard *drunk);\r\nvoid drunkard_start_random_westeast_edge(struct drunkard *drunk);\r\nvoid drunkard_start_random_northsouth_edge(struct drunkard *drunk);\r\nvoid drunkard_start_random_edge(struct drunkard *drunk);\r\nvoid drunkard_start_random_opened(struct drunkard *drunk);\r\n\r\nvoid drunkard_target_fixed(struct drunkard *drunk, int x, int y);\r\nvoid drunkard_target_random_west_edge(struct drunkard *drunk);\r\nvoid drunkard_target_random_east_edge(struct drunkard *drunk);\r\nvoid drunkard_target_random_north_edge(struct drunkard *drunk);\r\nvoid drunkard_target_random_south_edge(struct drunkard *drunk);\r\nvoid drunkard_target_random_westeast_edge(struct drunkard *drunk);\r\nvoid drunkard_target_random_northsouth_edge(struct drunkard *drunk);\r\nvoid drunkard_target_random_edge(struct drunkard *drunk);\r\nvoid drunkard_target_random_opened(struct drunkard *drunk);\r\n```\r\n\r\n### Marking Functions\r\n\r\n```\r\nvoid drunkard_mark_all(struct drunkard *drunk, unsigned tile);\r\nvoid drunkard_mark_1(struct drunkard *drunk, unsigned tile);\r\nvoid drunkard_mark_plus(struct drunkard *drunk, unsigned tile);\r\nvoid drunkard_mark_x(struct drunkard *drunk, unsigned tile);\r\nvoid drunkard_mark_rect(struct drunkard *drunk, int hw, int hh, unsigned tile);\r\nbool drunkard_try_mark_rect(struct drunkard *drunk, int hw, int hh, unsigned tile);\r\nunsigned drunkard_mark_shrinking_square(struct drunkard *drunk, int min, int max, unsigned tile);\r\nvoid drunkard_mark_circle(struct drunkard *drunk, int r, unsigned tile);\r\nbool drunkard_try_mark_circle(struct drunkard *drunk, int r, unsigned tile);\r\nunsigned drunkard_mark_shrinking_circle(struct drunkard *drunk, int min, int max, unsigned tile);\r\n```\r\n\r\n### Stepping Functions\r\n\r\n```\r\nvoid drunkard_step_by(struct drunkard *drunk, int dx, int dy);\r\nvoid drunkard_step_random(struct drunkard *drunk);\r\nvoid drunkard_step_to_target(struct drunkard *drunk, double weight);\r\n\r\nvoid drunkard_line_path_to_target(struct drunkard *drunk);\r\nvoid drunkard_tunnel_path_to_target(struct drunkard *drunk);\r\nbool drunkard_walk_path(struct drunkard *drunk);\r\nvoid drunkard_cancel_path(struct drunkard *drunk);\r\n```\r\n\r\n### Checking Functions\r\n\r\n```\r\nbool drunkard_is_on_opened(struct drunkard *drunk);\r\nbool drunkard_is_on_target(struct drunkard *drunk);\r\nbool drunkard_is_on_fixed(struct drunkard *drunk, int x, int y);\r\nbool drunkard_is_on_fixed_x(struct drunkard *drunk, int x);\r\nbool drunkard_is_on_fixed_y(struct drunkard *drunk, int y);\r\n```"}